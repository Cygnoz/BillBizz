import{r as u,u as S,e as B,_ as N,j as e,B as q,Q as U,M as z,U as Q,w as H,a as R,g as J,T as K,E as X}from"./index-A_edQTkL.js";import{P as Y}from"./PencilEdit-YyKjeo-p.js";import{P as Z}from"./Pagination-CosxQtyN.js";import{N as V}from"./NoDataFoundTable-hmwFq4Ia.js";import{T as ee}from"./TableSkelton-L9YeclyQ.js";import"./NO_DATA-Bek3dUYY.js";const te="/assets/CashImage-DDLsmhll.png",se=[{head:"Asset",subhead:["Current Asset","Non-Current Asset"]},{head:"Equity",subhead:["Equity"]},{head:"Income",subhead:["Sales","Indirect Income"]},{head:"Liability",subhead:["Current Liability","Non-Current Liability"]},{head:"Expenses",subhead:["Direct Expense","Cost of Goods Sold","Indirect Expense"]}],M={accountName:"",accountCode:"",accountSubhead:"",accountHead:"",accountGroup:"",description:"",bankAccNum:"",bankIfsc:"",bankCurrency:"",debitOpeningBalance:"",creditOpeningBalance:"",parentAccountId:""};function W({fetchAllAccounts:E,accountData:i,page:m}){var T,D;const[w,j]=u.useState(!1),{request:C}=S("post",5001),{request:y}=S("put",5001),[p,b]=u.useState("Debit"),[t,l]=u.useState(M),[v,f]=u.useState(!1),[k,O]=u.useState(!1),[g,_]=u.useState([]),{request:P}=S("get",5001),F={Asset:{Asset:["Current Asset","Non-Current Asset"]},Equity:{Equity:["Equity"]},Income:{Income:["Sales","Indirect Income"]},Liability:{Liabilities:["Current Liability","Non-Current Liability"]},Expenses:{Expenses:["Direct Expense","Cost of Goods Sold","Indirect Expense"]}};u.useEffect(()=>{I()},[]),u.useEffect(()=>{m==="Edit"&&i&&(l(i),i.parentAccountId?f(!0):f(!1),b(i.debitOpeningBalance?"Debit":"Credit"))},[m,i,w]);const I=async()=>{try{const n=`${B.Get_ALL_Acounts}`,{response:o,error:r}=await P(n);!r&&o?_(o.data):console.error("Failed to fetch account data.")}catch(n){N.error("Error in fetching data."),console.error("Error in fetching data",n)}},c=n=>{for(const[o,r]of Object.entries(F))for(const[d,a]of Object.entries(r))if(a.includes(n))return{accountHead:d,accountGroup:o==="Asset"||o==="Income"||o==="Equity"?"Asset":o==="Liability"||o==="Expenses"?"Liability":o};return null},s=n=>{const{name:o,value:r,type:d}=n.target;if(d==="checkbox"&&o==="returnableItem"){const a=n.target;f(a.checked),a.checked||l(A=>({...A,parentAccountId:""}));return}if(o==="accountSubhead"){const a=c(r);l(a?A=>({...A,accountSubhead:r,accountHead:a.accountHead,accountGroup:a.accountGroup,parentAccountId:""}):A=>({...A,accountSubhead:r,accountHead:"",accountGroup:"",parentAccountId:""}))}else if(o==="openingType")b(r),l(a=>({...a,debitOpeningBalance:r==="Debit"?a.debitOpeningBalance:"",creditOpeningBalance:r==="Credit"?a.creditOpeningBalance:""}));else if(o==="openingBalance"){if(parseFloat(r)<0)return;l(a=>({...a,debitOpeningBalance:p==="Debit"?r:a.debitOpeningBalance,creditOpeningBalance:p==="Credit"?r:a.creditOpeningBalance}))}else l(a=>({...a,[o]:r}))},h=()=>{m==="Edit"&&i&&(l(i),f(!!i.parentAccountId),b(i.debitOpeningBalance?"Debit":"Credit")),j(!0)},x=()=>{j(!1),l(M),f(!1),b("Debit"),O(!1)},L=async n=>{var o,r;if(n.preventDefault(),!t.accountSubhead){N.error("Please select an account type.");return}if(v&&!t.parentAccountId){O(!0),N.error("Please select a parent account.");return}try{const d=m==="Edit"?`${B.EDIT_NEW_ACCOUNT}/${t._id}`:B.Add_NEW_ACCOUNT,a=m==="Edit"?y:C,A=t,{response:G,error:$}=await a(d,A);!$&&G?(N.success(G.data.message),x(),E()):N.error($.response.data.message)}catch(d){N.error(((r=(o=d.response)==null?void 0:o.data)==null?void 0:r.message)||d.message||"Failed to add account")}};return console.log(t),e.jsxs("div",{children:[m==="Edit"?e.jsx("div",{onClick:h,className:"cursor-pointer",children:e.jsx(Y,{color:"#0B9C56"})}):e.jsxs(q,{onClick:h,variant:"primary",children:[e.jsx(U,{color:"white",size:"16"}),e.jsx("p",{className:"text-sm",children:"New Account"})]}),e.jsx(z,{open:w,onClose:x,className:"w-[68%] text-start",children:e.jsxs("div",{className:"p-5 mt-3",children:[e.jsxs("div",{className:"mb-5 flex p-4 rounded-xl bg-CreamBg relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-16 w-[178px] h-[89px]",style:{backgroundImage:`url(${Q})`}}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("h3",{className:"text-xl font-bold text-textColor",children:[m==="Edit"?"Edit":"Create"," Account"]}),e.jsx("p",{className:"text-dropdownText font-semibold text-sm mt-2",children:"Start your journey with us create your account in moments!"})]}),e.jsx("div",{className:"ms-auto text-3xl cursor-pointer relative z-10",onClick:x,children:"Ã—"})]}),e.jsxs("form",{className:"flex justify-between",onSubmit:L,children:[e.jsx("div",{children:e.jsx("img",{src:te,alt:"Cash"})}),e.jsxs("div",{className:"w-[65%]",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm text-labelColor mb-1",children:"Account Type"}),e.jsxs("select",{name:"accountSubhead",value:t.accountSubhead,onChange:s,className:"w-full border border-inputBorder rounded p-1.5 pl-2 text-sm",children:[e.jsx("option",{disabled:!0,hidden:!0,value:"",children:"Select type"}),se.map((n,o)=>e.jsx("optgroup",{className:"text-maroon",label:n.head,children:n.subhead.map((r,d)=>e.jsx("option",{className:"text-black option-spacing",value:r,children:r},d))},o))]})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"block text-sm mb-1 text-labelColor",children:(t==null?void 0:t.accountSubhead)==="Credit Card"?"Credit Card Name":"Account Name"}),e.jsx("input",{type:"text",name:"accountName",value:t.accountName,onChange:s,placeholder:(t==null?void 0:t.accountSubhead)==="Credit Card"?"Enter Credit Card Name":"Enter Account Name",className:"border-inputBorder w-full text-sm border rounded p-1.5 pl-2"})]}),t.accountSubhead&&!["Other Asset","Bank","Payment Clearing","Credit Card","Other Liability","Overseas Tax Payable","Other Income","Other Expense"].includes(t.accountSubhead)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-2 flex items-center gap-1 text-textColor",children:[e.jsx("input",{type:"checkbox",className:"accent-[#97998E] bg-white cursor-pointer h-5 w-4 mx-1 my-1",id:"checkbox3",name:"returnableItem",checked:v,onChange:s}),e.jsx("label",{htmlFor:"checkbox3",className:"text-dropdownText text-sm font-medium cursor-pointer",children:"Make this a sub-account"})]}),v&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"parentAccountId",className:"text-slate-600 text-sm flex items-center gap-2 mb-1",children:"Parent Account"}),e.jsxs("div",{className:"relative w-full",children:[e.jsxs("select",{className:`block appearance-none w-full mt-0.5 text-zinc-400 bg-white border text-sm h-9 pl-3 pr-8 rounded-md leading-tight focus:outline-none ${k?"border-red-500":"border-inputBorder"}`,name:"parentAccountId",onChange:n=>{const o=n.target.value,r=g==null?void 0:g.find(a=>a.accountName===o),d=r?r._id:"";l(a=>({...a,parentAccountId:d})),O(!1)},value:((T=g==null?void 0:g.find(n=>n._id===t.parentAccountId))==null?void 0:T.accountName)||"",children:[e.jsx("option",{value:"",children:"Select Parent Account"}),(D=g==null?void 0:g.filter(n=>n.accountSubhead===t.accountSubhead))==null?void 0:D.map(n=>e.jsx("option",{value:n.accountName,children:n.accountName},n._id))]}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700",children:e.jsx(H,{color:"gray"})})]}),k&&e.jsx("div",{className:"text-red-500 text-xs mt-1",children:"Please select a parent account."})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block mb-1 text-labelColor text-sm",children:"Opening Balance"}),e.jsxs("div",{className:"flex",children:[e.jsxs("div",{className:"relative w-20 ",children:[e.jsxs("select",{className:`block appearance-none w-full h-9 text-[#818894] bg-white border border-inputBorder \r
                                   text-sm pl-2 pr-2 rounded-l-md leading-tight \r
                                   focus:outline-none focus:bg-white focus:border-gray-500`,name:"openingType",value:p,onChange:s,children:[e.jsx("option",{value:"Debit",children:"Dr"}),e.jsx("option",{value:"Credit",children:"Cr"})]}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700",children:e.jsx(H,{color:"gray"})})]}),e.jsx("input",{type:"number",min:0,className:"text-sm w-[100%] rounded-r-md text-start bg-white border border-slate-300 h-9 p-2",placeholder:"Enter Opening Balance",name:"openingBalance",value:p==="Debit"?t.debitOpeningBalance:t.creditOpeningBalance,onChange:s})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm mb-1 text-labelColor",children:"Description"}),e.jsx("input",{name:"description",value:t.description,onChange:s,placeholder:"Enter Description",className:"border-inputBorder w-full text-sm border rounded p-1.5 pl-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1 text-labelColor",children:"Account Code"}),e.jsx("input",{type:"text",name:"accountCode",value:t.accountCode,onChange:s,placeholder:"Enter Account Code",className:"border-inputBorder w-full text-sm border rounded p-1.5 pl-2"})]}),e.jsx("br",{}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(q,{onClick:x,type:"button",variant:"secondary",className:"rounded text-sm h-10",children:"Cancel"}),e.jsxs(q,{type:"submit",variant:"primary",className:"rounded text-sm h-10",children:[m==="Edit"?"Edit":"Add"," Account"]})]})]})]})]})})]})}const ae=({accountData:E,searchValue:i,setSearchValue:m,loading:w,fetchAllAccounts:j})=>{const C=R(),[y,p]=u.useState(1),b=10,t=5,l=E.filter(c=>{var h,x,L,T,D,n,o,r,d,a;const s=i.toLowerCase();return((x=(h=c.accountName)==null?void 0:h.toLowerCase())==null?void 0:x.startsWith(s))||((T=(L=c.accountCode)==null?void 0:L.toLowerCase())==null?void 0:T.startsWith(s))||((n=(D=c.accountSubhead)==null?void 0:D.toLowerCase())==null?void 0:n.startsWith(s))||((r=(o=c.accountHead)==null?void 0:o.toLowerCase())==null?void 0:r.startsWith(s))||((a=(d=c.description)==null?void 0:d.toLowerCase())==null?void 0:a.startsWith(s))}).reverse(),v=Math.ceil(l.length/b),f=l.slice((y-1)*b,y*b),[k,O]=u.useState({});console.log(k,"oneAccountData");const{request:g}=S("get",5001),{request:_}=S("delete",5001),P=async c=>{try{const s=`${B.GET_ONE_ACCOUNT}/${c._id}`,{response:h,error:x}=await g(s);!x&&h?(O(h.data),console.log(h.data)):console.error("Failed to fetch one item data.")}catch(s){N.error("Error in fetching one item data."),console.error("Error in fetching one item data",s)}},F=async c=>{try{const s=`${B.DELETE_ACCONUT}/${c}`,{response:h,error:x}=await _(s);!x&&h?(N.success(h.data.message),j(),console.log(h.data)):N.error(x.response.data.message)}catch(s){N.error("Error in fetching one item data."),console.error("Error in fetching one item data",s)}};u.useEffect(()=>{p(1)},[i]);const I=["Sl.No","Account Name","Account Code","Account Type","Parent Account Type","Actions",""];return e.jsxs("div",{children:[e.jsx(J,{placeholder:"Search",searchValue:i,onSearchChange:m}),e.jsx("div",{className:"min-h-[25rem] overflow-y-auto mt-1",children:e.jsxs("table",{className:"min-w-full bg-white mb-5",children:[e.jsx("thead",{className:"text-[12px] text-center text-dropdownText sticky top-0 z-10",children:e.jsx("tr",{style:{backgroundColor:"#F9F7F0"},children:I.map((c,s)=>e.jsx("th",{className:"py-3 px-4 font-medium border-b border-tableBorder",children:c},s))})}),e.jsx("tbody",{className:"text-dropdownText text-center text-[13px]",children:w.skeleton?[...Array(f.length>0?f.length:5)].map((c,s)=>e.jsx(ee,{columns:I},s)):f&&f.length>0?f.map((c,s)=>e.jsxs("tr",{className:"relative",children:[e.jsx("td",{className:"py-2.5 px-4 border-y border-tableBorder",children:(y-1)*b+s+1}),e.jsx("td",{className:"py-2.5 px-4 border-y border-tableBorder",children:c.accountName}),e.jsx("td",{className:"py-2.5 px-4 border-y border-tableBorder",children:c.accountCode}),e.jsx("td",{className:"py-2.5 px-4 border-y border-tableBorder",children:c.accountSubhead}),e.jsx("td",{className:"py-2.5 px-4 border-y border-tableBorder",children:c.accountHead}),e.jsxs("td",{className:"py-3 gap-3 px-4 border-b border-tableBorder flex justify-center items-center",children:[e.jsx("div",{onClick:()=>F(c._id),children:e.jsx(K,{color:"red"})}),e.jsx("div",{onClick:()=>{P(c)},children:e.jsx(W,{page:"Edit",fetchAllAccounts:()=>{},accountData:k})}),e.jsx("div",{onClick:()=>C(`/accountant/view/${c._id}`),className:"cursor-pointer",children:e.jsx(X,{color:"#569FBC"})})]}),e.jsx("td",{className:"cursor-pointer py-2.5 px-4 border-y border-tableBorder",children:e.jsx("div",{className:"flex justify-end"})})]},c._id)):e.jsx(V,{columns:I})})]})}),e.jsx(Z,{currentPage:y,totalPages:v,onPageChange:c=>p(c),maxVisiblePages:t})]})},de=({})=>{const[E,i]=u.useState([]),[m,w]=u.useState(""),[j,C]=u.useState({skelton:!1,noDataFound:!1}),{request:y}=S("get",5001);u.useEffect(()=>{p()},[]);const p=async()=>{try{const t=`${B.Get_ALL_Acounts}`;C({...j,skeleton:!0});const{response:l,error:v}=await y(t);if(v||!l){C({...j,skeleton:!1,noDataFound:!0});return}i(l.data),C({...j,skeleton:!1})}catch(t){console.error("Error fetching accounts:",t),C({...j,skeleton:!1,noDataFound:!0})}},b=()=>{p()};return e.jsxs("div",{className:"mx-5 my-4",children:[e.jsxs("div",{className:"top-side flex items-center justify-between",children:[e.jsxs("div",{className:"head-frame",children:[e.jsx("h1",{className:"font-bold text-2xl text-textColo",children:"Chart Of Account"}),e.jsx("p",{className:"text-sm mt-1",children:"It serves as a framework for organizing financial data and helps ensure accurate and consistent reporting"})]}),e.jsx("div",{className:"button-frame me-4",children:e.jsx(W,{accountData:E,fetchAllAccounts:b})})]}),e.jsx("br",{}),e.jsx("div",{className:"flex flex-col gap-3 p-3 bg-white mt-1",children:e.jsx(ae,{fetchAllAccounts:p,accountData:E,searchValue:m,setSearchValue:w,loading:j})})]})};export{de as default};
