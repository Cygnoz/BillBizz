import{a as B,r as a,I as J,u as y,j as e,g as L,E as I,T,W as _,e as N,_ as f,L as F,B as O,P as R}from"./index-A_edQTkL.js";import{A as M,a as w}from"./ArrowUpIcon-BSlCnyZT.js";import{N as $}from"./NoDataFoundTable-hmwFq4Ia.js";import{T as P}from"./TableSkelton-L9YeclyQ.js";import{P as V}from"./PencilEdit-YyKjeo-p.js";import"./NO_DATA-Bek3dUYY.js";function U({}){const d=B(),{loading:t,setLoading:o}=a.useContext(J),[i,c]=a.useState([]),[u,n]=a.useState(""),[m,p]=a.useState(!1),[h,b]=a.useState(null),v=r=>{b(r),p(!0)},{request:C}=y("get",5001),{request:k}=y("delete",5001),j=["Date","Journal","Reference#","Notes","Amount","Actions"],g=async()=>{try{const r=`${N.GET_ALL_JOURNALS}`;o({...t,skeleton:!0});const{response:s,error:l}=await C(r);if(l||!s){o({...t,skeleton:!1,noDataFound:!0});return}c(s.data),o({...t,skeleton:!1})}catch(r){console.error("Something went wrong:",r),o({...t,noDataFound:!0,skelton:!1})}};a.useEffect(()=>{g()},[]);const x=i.filter(r=>{var l;const s=u.toLowerCase().trim();return((l=r.journalId)==null?void 0:l.toString().toLowerCase().startsWith(s))||!1}),D=r=>{d(`/accountant/editjournal/${r}`)},E=async()=>{if(h)try{const r=`${N.DELET_JOURNAL}/${h}`,{response:s,error:l}=await k(r);!l&&s?(f.success(s.data.message),i.length===1?(c([]),o({...t,skeleton:!1,noDataFound:!0})):c(A=>A.filter(S=>S._id!==h)),await g()):f.error(l.response.data.message)}catch{f.error("Error occurred while deleting the journal.")}finally{p(!1),b(null)}};return e.jsxs("div",{className:"overflow-x-auto my-1",children:[e.jsx("div",{className:"mb-3",children:e.jsx(L,{onSearchChange:n,searchValue:u,placeholder:"Search Journals"})}),e.jsxs("table",{className:"min-w-full bg-white mb-5",children:[e.jsx("thead",{className:"text-[12px] text-center text-dropdownText",children:e.jsxs("tr",{style:{backgroundColor:"#F9F7F0"},children:[e.jsx("th",{className:"py-3 px-4 border-b border-tableBorder",children:"Sl No"}),j.map((r,s)=>e.jsx("th",{className:"py-2 px-4 font-medium border-b border-tableBorder",children:r},s))]})}),e.jsx("tbody",{className:"text-dropdownText text-center text-[13px]",children:t.skeleton?[...Array(x.length?x.length:5)].map((r,s)=>e.jsx(P,{columns:[...j,"rr"]},s)):x.length>0?x.reverse().map((r,s)=>e.jsxs("tr",{className:"relative",children:[e.jsx("td",{className:"py-2.5 px-4 border-y border-tableBorder",children:s+1}),e.jsx("td",{className:"py-2.5 px-4 border-y border-tableBorder",children:r.date}),e.jsx("td",{className:"py-2.5 px-4 border-y border-tableBorder",children:r.journalId?r.journalId:"-"}),e.jsx("td",{className:"py-2.5 px-4 border-y border-tableBorder",children:r.reference?r.reference:"-"}),e.jsx("td",{className:"py-2.5 px-4 border-y border-tableBorder",children:r.note?r.note:"-"}),e.jsx("td",{className:"py-2.5 px-4 border-y border-tableBorder",children:r.totalDebitAmount?r.totalDebitAmount:"-"}),e.jsxs("td",{className:"py-2.5 px-4 border-y border-tableBorder gap-3 flex justify-center items-center",children:[e.jsx("div",{onClick:()=>D(r._id),children:e.jsx(V,{color:"#0B9C56",className:"cursor-pointer"})}),e.jsx("div",{onClick:()=>d(`/accountant/manualjournal/view/${r._id}`),children:e.jsx(I,{color:"#569FBC",className:"cursor-pointer"})}),e.jsx("div",{onClick:()=>v(r._id),children:e.jsx(T,{color:"red"})})]})]},r._id)):e.jsx($,{columns:[...j,"rr"]})})]}),e.jsx(_,{open:m,onClose:()=>p(!1),onConfirm:E,message:"Are you sure you want to delete?"})]})}function Q({}){const[d,t]=a.useState(!1),o=a.useRef(null),i=()=>{t(!d)},c=n=>{o.current&&!o.current.contains(n.target)&&t(!1)};a.useEffect(()=>(document.addEventListener("mousedown",c),()=>{document.removeEventListener("mousedown",c)}),[]);const u=[{icon:e.jsx(M,{}),text:"Import Journel",onClick:()=>{console.log("Import Sales Order clicked")}},{icon:e.jsx(w,{}),text:"Export Journel",onClick:()=>{console.log("Export Sales Order clicked")}},{icon:e.jsx(w,{}),text:"Manage Journel",onClick:()=>{console.log("Export Current View clicked")}}];return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mx-5 my-4  h-[100vh]",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-2xl text-textColor",children:"Manual Journals"}),e.jsx("p",{className:"text-sm text-gray mt-1",children:"A manual journal is a ledger entry used to record financial transaction by hand, typically fo adjustment or entries not processed through automated system"})]}),e.jsxs("div",{className:"ml-auto gap-3 flex items-center",children:[e.jsx(F,{to:"/accountant/newjournal",children:e.jsxs(O,{variant:"primary",size:"xl",children:[e.jsx(R,{color:"white"}),e.jsx("p",{className:"text-sm",children:"New Journel"})]})}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{onClick:i,className:"cursor-pointer"}),d&&e.jsx("div",{ref:o,className:"absolute top-full right-0 mt-2 w-48 bg-white shadow-xl z-10",children:e.jsx("ul",{className:"py-1 text-dropdownText",children:u.map((n,m)=>e.jsxs("li",{onClick:n.onClick,className:"px-4 py-2 flex items-center gap-2 hover:bg-orange-100 rounded-md text-sm cursor-pointer",children:[n.icon,n.text]},m))})})]})]}),e.jsx("div",{})]}),e.jsx("div",{className:"mt-5 bg-white  p-5 rounded-xl",children:e.jsx("div",{children:e.jsx(U,{})})})]})})}export{Q as default};
