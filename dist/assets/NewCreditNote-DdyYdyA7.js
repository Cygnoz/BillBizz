import{r,u as E,j as e,az as fe,ap as Ne,g as ie,T as je,P as ve,_ as O,e as I,a as ye,X as Ae,L as Ce,x as we,w as $,ae as Te,a9 as Ie,B as pe}from"./index-A_edQTkL.js";import{N as Ee}from"./NewCustomerModal-CBewSJCy.js";const ke=({SalesOrderState:p,setSalesOrderState:i,isInterState:m,selectedInvoice:f})=>{var Z;const[F,G]=r.useState(null),[S,k]=r.useState(null),[q,g]=r.useState(""),[B,U]=r.useState([]),{request:H}=E("get",5003),J=r.useRef([]),V=r.useRef(null),[d,y]=r.useState([{itemId:"",itemName:"",quantity:"",sellingPrice:"",itemTotaltax:"",itemAmount:"",sgst:"",cgst:"",igst:"",vat:"",sgstAmount:"",cgstAmount:"",igstAmount:"",vatAmount:"",stock:"",taxPreference:"",salesAccountId:""}]),ee=(t,s,l)=>{l.itemName||(G(o=>o===t?null:t),k(s))},z=t=>{V.current&&!V.current.contains(t.target)&&(G(null),k(null))},W=()=>{const t={itemId:"",itemName:"",quantity:"",sellingPrice:"",itemTotaltax:"",itemAmount:"",sgst:"",cgst:"",igst:"",sgstAmount:"",cgstAmount:"",igstAmount:"",vat:"",vatAmount:"",stock:"",taxPreference:"",salesAccountId:""},s=[...d,t];y(s)},te=(t,s)=>{G(null),k(null);const l=[...d];l[s]={...l[s],itemName:t.itemName,sellingPrice:t.sellingPrice,quantity:1,itemId:t.itemId,cgst:t.cgst,sgst:t.sgst,igst:t.igst,itemAmount:t.itemAmount,stock:t.returnQuantity?t.quantity-t.returnQuantity:t.quantity,taxPreference:t.taxPreference,salesAccountId:t.salesAccountId};const o=Number(l[s].sellingPrice),u=Number(l[s].quantity)*o,{itemAmount:A,cgstAmount:w,sgstAmount:j,igstAmount:T}=v(u,l[s],m);l[s].itemAmount=m?(A+T).toFixed(2):(A+w+j).toFixed(2),l[s].cgstAmount=w,l[s].sgstAmount=j,l[s].igstAmount=T,console.log(T,j,w,"igstsvdjgjgh"),m?l[s].itemTotaltax=T:l[s].itemTotaltax=w+j,y(l),i==null||i(C=>({...C,items:l==null?void 0:l.map(R=>{const M={...R};return delete M.itemImage,M})}))},v=(t,s,l)=>{const o=s.cgst||0,x=s.sgst||0,u=s.igst||0;console.log(o,x,u,"qwertyui");let A=0,w=0,j=0;return l?j=t*u/100:(A=t*o/100,w=t*x/100),{itemAmount:t,cgstAmount:A,sgstAmount:w,igstAmount:j}},L=(t,s,l)=>{const o=[...d];o[t]={...o[t],[s]:l};const x=Number(o[t].quantity),u=Number(o[t].sellingPrice),A=Number(o[t].stock);if(x>A){o[t].quantity=A.toString(),O.error("The entered quantity exceeds available stock.");return}const w=x*u,{itemAmount:j,cgstAmount:T,sgstAmount:C,igstAmount:R}=v(w,o[t],m);o[t].itemAmount=m?(j+R).toFixed(2):(j+T+C).toFixed(2),o[t].cgstAmount=T,o[t].sgstAmount=C,o[t].igstAmount=R,m?(o[t].itemTotaltax=R,o[t].cgstAmount="",o[t].sgstAmount=""):(o[t].itemTotaltax=T+C,o[t].igstAmount=""),y(o),i==null||i(M=>({...M,items:o==null?void 0:o.map(le=>{const Y={...le};return delete Y.itemImage,Y})}))},X=async()=>{try{const t=`${I.GET_ALL_ITEMS_SALES}`,s=await H(t),{response:l,error:o}=s;!o&&l?U(l.data):console.log(o)}catch(t){console.error("Error fetching items:",t)}},se=t=>{if(d.length>1){const s=d==null?void 0:d.filter((l,o)=>o!==t);y(s),i==null||i(l=>({...l,items:s}))}else{const s={itemId:"",itemName:"",quantity:"",sellingPrice:"",itemTotaltax:"",itemAmount:"",sgst:"",cgst:"",igst:"",vat:"",sgstAmount:"",cgstAmount:"",igstAmount:"",vatAmount:"",stock:"",taxPreference:"",salesAccountId:""};y([s]),i==null||i(l=>({...l,items:[s]}))}},a=()=>d.reduce((t,s)=>{const l=m?0:Number(s.sgstAmount)||0;return t+l},0),P=()=>d.reduce((t,s)=>{console.log(s.cgstAmount,"total cgst");const l=m?0:Number(s.cgstAmount)||0;return t+l},0),ne=()=>d.reduce((t,s)=>{const l=m&&Number(s.igstAmount)||0;return t+l},0),oe=()=>d.reduce((t,s)=>{var o;const l=parseFloat(((o=s.quantity)==null?void 0:o.toString())||"0");return t+l},0),N=()=>d.reduce((t,s)=>{const l=Number(s.quantity)||0,o=Number(s.sellingPrice)||0,x=l*o;return t+x},0);r.useEffect(()=>(F!==null?document.addEventListener("mousedown",z):document.removeEventListener("mousedown",z),()=>{document.removeEventListener("mousedown",z)}),[F]),r.useEffect(()=>{const t=oe(),s=a(),l=P(),o=ne(),x=N();i==null||i(u=>({...u,totalItem:t,sgst:m?"":s,cgst:m?"":l,igst:m?o:"",subTotal:x,totalTax:m?o:s+l,totalAmount:x+p.totalTax}))},[d,p.totalTax]),r.useEffect(()=>{const t=d==null?void 0:d.map(s=>{const l=(Number(s.sellingPrice)||0)*(Number(s.quantity)||0),o=v(l,s,m);return{...s,itemAmount:m?o.itemAmount+o.igstAmount:o.itemAmount+o.cgstAmount+o.sgstAmount,cgstAmount:o.cgstAmount>0?o.cgstAmount:"",sgstAmount:o.sgstAmount>0?o.sgstAmount:"",igstAmount:o.igstAmount>0?o.igstAmount:""}});y(t),i==null||i(s=>({...s,items:t==null?void 0:t.map(l=>{const o={...l};return delete o.itemImage,o})}))},[m,p==null?void 0:p.placeOfSupply]),r.useEffect(()=>{if((f==null?void 0:f.length)==0){const t={itemId:"",itemName:"",quantity:"",sellingPrice:"",itemTotaltax:"",itemAmount:"",sgst:"",cgst:"",igst:"",vat:"",sgstAmount:"",cgstAmount:"",igstAmount:"",vatAmount:"",stock:"",taxPreference:"",salesAccountId:""};y([t]),i==null||i(s=>({...s,items:[t],totalAmount:0}))}},[f]);const Q=()=>{var t;return(t=f==null?void 0:f.items)==null?void 0:t.filter(s=>{var o;return!d.some(x=>x.itemId===s.itemId)&&((o=s==null?void 0:s.itemName)==null?void 0:o.toLowerCase().includes(q.toLowerCase()))&&(B==null?void 0:B.some(x=>x._id===(s==null?void 0:s.itemId)))})};return r.useEffect(()=>{if(p!=null&&p.items&&JSON.stringify(p.items)!==JSON.stringify(J.current)){const t=p.items.map(s=>{const l=B.find(o=>o._id===s.itemId);return{...s,itemStock:(l==null?void 0:l.currentStock)||"",salesAccountId:(l==null?void 0:l.salesAccountId)||s.salesAccountId||""}});y(t),J.current=p.items}},[p==null?void 0:p.items,B]),r.useEffect(()=>{X()},[]),e.jsxs("div",{children:[e.jsx("div",{className:"rounded-lg border-2 border-tableBorder mt-5",children:e.jsxs("table",{className:"min-w-full bg-white rounded-lg relative pb-4 border-dropdownText",children:[e.jsx("thead",{className:"text-[12px] text-center text-dropdownText",children:e.jsx("tr",{className:"bg-lightPink",children:(Z=fe)==null?void 0:Z.map((t,s)=>e.jsx("th",{className:"py-2 px-4 font-medium border-b border-tableBorder relative",children:t},s))})}),e.jsx("tbody",{className:"text-dropdownText text-center text-[13px] ",children:d==null?void 0:d.map((t,s)=>{var l,o,x;return e.jsxs("tr",{children:[e.jsxs("td",{className:"border-y py-3 px-2 border-tableBorder",children:[e.jsx("div",{className:"relative w-full",onClick:()=>ee(s,"searchProduct",t),children:t.itemName?e.jsxs("div",{className:"cursor-pointer gap-2 grid grid-cols-12 appearance-none items-center justify-center h-9 text-zinc-400 bg-white text-sm",children:[e.jsx("div",{className:"flex items-start col-span-4",children:e.jsx("img",{className:"rounded-full h-10 w-10 ",src:t.itemImage,alt:""})}),e.jsx("div",{className:"col-span-8  text-start",children:e.jsx("p",{className:"text-textColor",children:t.itemName})})]}):e.jsxs("div",{className:"cursor-pointer flex appearance-none items-center justify-center h-9 text-zinc-400 bg-white text-sm",children:[e.jsx("p",{children:"Type or click"}),e.jsx(Ne,{strokeWidth:"",color:"currentColor"})]})}),F===s&&S==="searchProduct"&&e.jsxs("div",{ref:V,className:"absolute z-10 bg-white shadow rounded-md mt-1 p-2 w-[30%] space-y-1",children:[e.jsx(ie,{searchValue:q,onSearchChange:g,placeholder:"Select Item"}),((l=f==null?void 0:f.items)==null?void 0:l.length)>=0?((o=Q())==null?void 0:o.length)>0?(x=Q())==null?void 0:x.map((u,A)=>e.jsxs("div",{className:"grid grid-cols-12 gap-1 p-2 hover:bg-gray-100 cursor-pointer border border-slate-400 rounded-lg bg-lightPink",onClick:()=>te(u,s),children:[e.jsx("div",{className:"col-span-2 flex justify-center",children:e.jsx("img",{className:"rounded-full h-10",src:u.itemImage,alt:""})}),e.jsx("div",{className:"col-span-10 flex",children:e.jsxs("div",{className:"text-start",children:[e.jsx("p",{className:"font-bold text-sm text-black",children:u.itemName}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Rate: ",u.sellingPrice]})]})})]},A)):e.jsx("div",{className:"text-center border-slate-400 border rounded-lg",children:e.jsx("p",{className:"text-[red] text-sm py-4",children:"Items Not Found!"})}):e.jsx("div",{className:"text-center border-slate-400 border rounded-lg",children:e.jsx("p",{className:"text-[darkRed] text-sm py-4 px-4",children:"Please select a invoice to view items!"})})]})]}),e.jsxs("td",{className:"py-2.5 px-4 border-y border-tableBorder",children:[e.jsx("input",{type:"text",placeholder:"0",className:"w-[50px]  focus:outline-none text-center",value:t.quantity||"",onChange:u=>L(s,"quantity",u.target.value)})," ",e.jsx("br",{}),"Stock : ",t.stock?t.stock:"0"]}),e.jsx("td",{className:"py-2.5 px-4 border-y border-tableBorder",children:e.jsx("input",{type:"text",placeholder:"0",className:"w-[50px]  focus:outline-none text-center",value:t.sellingPrice,onChange:u=>L(s,"sellingPrice",u.target.value),disabled:!0})}),e.jsx("td",{className:"py-2.5 px-4 border-y border-tableBorder",children:e.jsx("input",{disabled:!0,type:"text",placeholder:"0",className:"w-[50px] focus:outline-none text-center",value:m?(t.igstAmount||0)===0?"nil":t.igstAmount:(t.cgstAmount||0)+(t.sgstAmount||0)===0?"nil":t.cgstAmount+t.sgstAmount})}),e.jsx("td",{className:"py-2.5 px-4 border-y border-tableBorder",children:e.jsx("input",{disabled:!0,type:"text",placeholder:"0",className:"w-[50px]  focus:outline-none text-center",value:t.itemAmount,onChange:u=>L(s,"itemAmount",u.target.value)})}),e.jsx("td",{className:"py-2.5 px-4 border-y border-tableBorder",children:e.jsx("div",{className:"text-center flex justify-center gap-2",onClick:()=>se(s),children:e.jsx(je,{color:"darkRed"})})})]},s)})})]})}),e.jsx("div",{className:"w-[60%] mt-0",children:e.jsxs("button",{type:"button",className:"bg-darkGreen text-darkRed rounded-lg py-2 px-6 flex items-center text-sm font-bold",onClick:W,children:[e.jsx(ve,{color:"darkRed"}),"Add Item"]})})]})},Pe={organizationId:"",customerId:"",customerDisplayName:"",placeOfSupply:"",invoiceId:"",invoiceNumber:"",invoiceDate:"",invoiceType:"",creditNote:"",orderNumber:"",customerCreditDate:"",paymentMode:"",paidThroughAccountId:"",subject:"",items:[{itemId:"",itemName:"",quantity:"",sellingPrice:"",taxPreference:"",itemAmount:"",sgst:"",cgst:"",igst:"",vat:"",sgstAmount:"",cgstAmount:"",igstAmount:"",vatAmount:"",itemTotaltax:"",salesAccountId:""}],addNotes:"",attachFiles:"",termsAndConditions:"",subTotal:0,totalItem:0,sgst:0,cgst:0,igst:0,vat:0,totalTax:0,totalAmount:0},qe=({page:p})=>{var me;const[i,m]=r.useState(""),[f,F]=r.useState([]),[G,S]=r.useState([]),[k,q]=r.useState(null),[g,B]=r.useState([]),[U,H]=r.useState(!1),[J,V]=r.useState([]),[d,y]=r.useState(null),[ee,z]=r.useState(!0),[W,te]=r.useState([]),[v,L]=r.useState([]),[X,se]=r.useState([]),[a,P]=r.useState(Pe);console.log(a,"creditNoteState");const[ne,oe]=r.useState({invoiceNumber:!1,customerId:!1,placeOfSupply:!1,paymentMode:!1,paidThroughAccountId:!1,itemTable:!1,orderNumber:!1,customerCreditDate:!1}),[N,Q]=r.useState(""),{request:Z}=E("get",5002),{request:t}=E("get",5004),{request:s}=E("get",5004),{request:l}=E("get",5007),{request:o}=E("get",5007),{request:x}=E("get",5001),{request:u}=E("post",5007),{request:A}=E("get",5007),{request:w}=E("put",5007),j=r.useRef(null),T=ye(),C=async(n,c,h)=>{try{const{response:b,error:_}=await h(n);!_&&b&&c(b.data)}catch(b){console.error("Error fetching data:",b)}},R=(n,c,h)=>n.filter(b=>{var _;return(_=b[c])==null?void 0:_.toLowerCase().includes(h.toLowerCase())}),M=async()=>{try{const n=`${I.GET_ALL_SALES_INVOICE}`,{response:c,error:h}=await o(n);if(h||!c){L([]);return}L(c.data||[])}catch(n){console.error("Error fetching invoices:",n),L([])}};r.useEffect(()=>{M()},[]);const le=()=>{if(g.organizationCountry){const n=J.find(c=>c.name.toLowerCase()===g.organizationCountry.toLowerCase());if(g&&P(c=>({...c,placeOfSupply:g.state})),n){const c=n.states;S(c)}else console.log("Country not found")}else console.log("No country selected")},Y=async()=>{try{const n=`${I.GET_COUNTRY_DATA}`,{response:c,error:h}=await s(n);!h&&c&&V(c.data[0].countries)}catch(n){console.log("Error in fetching Country",n)}};r.useEffect(()=>{const n=`${I.GET_ONE_ORGANIZATION}`,c=`${I.Get_ALL_Acounts}`,h=`${I.GET_ALL_CUSTOMER}`,b=`${I.GET_CREDIT_NOTE_PREFIX}`;C(b,se,l),C(h,F,Z),C(n,B,t),C(c,te,x)},[]),r.useEffect(()=>{P(n=>({...n,creditNote:X}))},[X]),r.useEffect(()=>{le(),Y()},[g]);const D=n=>{const{name:c,value:h}=n.target;P({...a,[c]:h})},de=R(f,"customerDisplayName",i),{id:ae}=Ae();r.useEffect(()=>{(async()=>{const c=`${I.GET_ALL_CUSTOMER}`,h=`${I.GET_ONE_CREDIT_NOTE}/${ae}`;await C(c,F,Z),p==="edit"&&await C(h,P,A)})()},[p,ae]),r.useEffect(()=>{if(a.customerId&&f.length){const n=f.find(c=>c._id===a.customerId);n&&Q(n)}if(a&&(v!=null&&v.length)){const{invoiceId:n}=a;if(n){const c=v.find(h=>h._id===n);console.log("Selected Invoice:",c),console.log("Invoice ID:",n),console.log("All Invoices:",v),c?y(c):console.warn("Invoice not found for the given ID.")}}},[a,f,v]),console.log("Selected Invoice State:",d);const he=async()=>{var c,h;const n={...ne};if(n.invoiceNumber=typeof a.invoiceNumber=="string"?a.invoiceNumber.trim()==="":!1,a.customerId.trim()===""?n.customerId=!0:n.customerId=!1,a.placeOfSupply.trim()===""?n.placeOfSupply=!0:n.placeOfSupply=!1,a.customerCreditDate.trim()===""?n.customerCreditDate=!0:n.customerCreditDate=!1,a.paymentMode.trim()===""?n.paymentMode=!0:n.paymentMode=!1,a.paidThroughAccountId.trim()===""?n.paidThroughAccountId=!0:n.paidThroughAccountId=!1,Object.values(n).some(b=>b)){oe(n),O.error("Fill the required fields");return}try{let b,_;p==="edit"?(b=`${I.EDIT_CREDIT_NOTE}/${ae}`,_=w):(console.log("working"),b=`${I.ADD_CREDIT_NOTE}`,_=u);const{response:xe,error:K}=await _(b,a);!K&&xe?(O.success(xe.data.message),setTimeout(()=>{T("/sales/credit-note")},1e3)):O.error((h=(c=K==null?void 0:K.response)==null?void 0:c.data)==null?void 0:h.message)}catch(b){console.log(b)}},ce=n=>{q(n===k?null:n)},ge=n=>{n.taxType==="GST"?z(!0):z(!1)};r.useEffect(()=>{N&&ge(N)},[N]);const re=n=>{j.current&&!j.current.contains(n.target)&&q(null)};r.useEffect(()=>{(a==null?void 0:a.placeOfSupply)!==g.state?H(!0):H(!1)},[a==null?void 0:a.placeOfSupply]),r.useEffect(()=>(k!==null?document.addEventListener("mousedown",re):document.removeEventListener("mousedown",re),()=>{document.removeEventListener("mousedown",re)}),[k]);const ue=N&&Object.keys(N).length>0?v==null?void 0:v.filter(n=>{var c;return n.customerId===(N==null?void 0:N._id)&&((c=n.salesInvoice)==null?void 0:c.toLowerCase().includes(i.toLowerCase()))}):[],be=()=>{T(-1)};return e.jsxs("div",{className:"mx-5 my-4",children:[e.jsxs("div",{className:"flex gap-5",children:[e.jsx(Ce,{to:"/sales/credit-note",children:e.jsx("div",{className:"flex justify-center items-center h-11 w-11 bg-tertiary_main rounded-full",children:e.jsx(we,{})})}),e.jsx("div",{className:"flex justify-center items-center",children:e.jsx("h4",{className:"font-bold text-xl text-textColor",children:"Credit Note"})})]}),e.jsxs("div",{className:"grid grid-cols-12 gap-4 py-5 rounded-lg",children:[e.jsx("div",{className:"col-span-8",children:e.jsx("div",{className:"bg-[#FFFFFF] p-5 min-h-max rounded-xl relative ",children:e.jsxs("div",{className:" mt-5 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-12 gap-4",children:[e.jsxs("div",{className:"col-span-6",children:[e.jsxs("label",{className:"text-sm mb-1 text-labelColor",children:["Customer Name ",e.jsx("span",{className:"text-[#bd2e2e]",children:"*"})]}),e.jsxs("div",{className:"relative w-full",onClick:()=>ce("customer"),children:[e.jsx("div",{className:`items-center flex appearance-none w-full h-9 text-zinc-400 bg-white border\r
           border-inputBorder text-sm pl-2 pr-8 rounded-md leading-tight focus:outline-none focus:bg-white focus:border-gray-500 cursor-pointer`,children:e.jsx("p",{children:(N==null?void 0:N.customerDisplayName)??"Select Customer"})}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700",children:e.jsx($,{color:"gray"})})]}),k==="customer"&&e.jsxs("div",{ref:j,className:"absolute z-10 bg-white shadow rounded-md mt-1 p-2 space-y-1 max-w-80 max-h-80 overflow-y-auto",style:{width:"80%"},children:[e.jsx(ie,{searchValue:i,onSearchChange:m,placeholder:"Search customer"}),de?de.map(n=>e.jsxs("div",{className:`grid grid-cols-12 gap-1 p-2 hover:bg-gray-100 cursor-pointer\r
                border border-slate-400 rounded-lg bg-lightPink`,onClick:()=>{P(c=>({...c,customerId:n._id,customerDisplayName:n.customerDisplayName,orderNumber:"",invoiceNumber:"",invoiceId:"",invoiceDate:""})),q(null),Q(n),y([])},children:[e.jsx("div",{className:"col-span-2 flex items-center justify-center",children:e.jsx("img",{src:"https://i.postimg.cc/MHdYrGVP/Ellipse-43.png",alt:""})}),e.jsx("div",{className:"col-span-10 flex",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-sm",children:n.customerDisplayName}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Phone: ",n.mobile]})]})})]})):e.jsx("div",{className:"text-center border-slate-400 border rounded-lg",children:e.jsx("p",{className:"text-[darkRed] text-sm py-4",children:"Customer Not Found!"})}),e.jsx("div",{className:"hover:bg-gray-100 cursor-pointer border border-slate-400 rounded-lg py-4",children:e.jsx(Ee,{page:"purchase"})})]})]}),ee&&e.jsx("div",{className:"col-span-6",children:e.jsxs("label",{className:"block  text-sm mb-1 text-labelColor",children:["Place Of Supply ",e.jsx("span",{className:"text-[#bd2e2e] ",children:"*"}),e.jsxs("div",{className:"relative w-full",children:[e.jsxs("select",{name:"placeOfSupply",onChange:D,value:a.placeOfSupply,className:`block appearance-none w-full h-9 text-zinc-400 bg-white border\r
                                   border-inputBorder text-sm pl-2 pr-8 rounded-md leading-tight\r
                                   focus:outline-none focus:bg-white focus:border-gray-500`,children:[e.jsx("option",{value:"",children:"Select place Of Supply"}),G&&G.map((n,c)=>e.jsx("option",{value:n,className:"text-gray",children:n},c))]}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700",children:e.jsx($,{color:"gray"})})]})]})}),e.jsxs("div",{className:"col-span-6",children:[e.jsx("label",{className:"block text-sm mb-1 text-labelColor",children:"Credit Note#"}),e.jsxs("div",{className:" flex items-center border rounded-lg border-inputBorder",children:[e.jsx("input",{readOnly:!0,value:a.creditNote,name:"creditNote",onChange:D,className:"w-full text-sm p-1.5 pl-2 h-9 border-none outline-none rounded-l-lg"}),e.jsx("div",{className:"p-1.5",children:e.jsx(Te,{color:"#495160"})})]})]}),e.jsxs("div",{className:"col-span-6 hidden",children:[e.jsx("label",{className:"block text-sm mb-1 text-labelColor",children:"Sales Order Number"}),e.jsx("input",{name:"orderNumber",value:a.orderNumber,onChange:D,id:"",placeholder:"Value",className:"border-inputBorder w-full text-sm border rounded p-1.5 pl-2 h-9"})]}),e.jsxs("div",{className:"col-span-6",children:[e.jsxs("label",{htmlFor:"",className:"block text-sm mb-1 text-labelColor",onClick:()=>ce("invoice"),children:["Invoice# ",e.jsx("span",{className:"text-[#bd2e2e]",children:"*"})]}),e.jsxs("div",{className:"relative w-full",onClick:()=>ce("invoice"),children:[e.jsx("div",{className:"items-center flex appearance-none w-full h-9 text-zinc-400 bg-white border border-inputBorder text-sm pl-2 pr-8 rounded-md leading-tight focus:outline-none focus:bg-white focus:border-gray-500 cursor-pointer",children:e.jsx("p",{children:(d==null?void 0:d.salesInvoice)||"Select Invoice"})}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700",children:e.jsx($,{color:"gray"})})]}),k==="invoice"&&e.jsxs("div",{ref:j,className:"absolute z-10 bg-white shadow rounded-md mt-1 p-2 w-[47%] space-y-1 max-h-72 overflow-y-auto hide-scrollbar",children:[e.jsx(ie,{searchValue:i,onSearchChange:m,placeholder:"Search Invoice"}),ue.length>0?ue.map(n=>e.jsx("div",{className:"gap-1 p-2 hover:bg-gray-100 cursor-pointer border border-slate-400 rounded-lg bg-lightPink ",onClick:()=>{P(c=>({...c,invoiceId:n._id,invoiceNumber:n.salesInvoice,invoiceDate:n.salesInvoiceDate,orderNumber:n.salesOrderNumber})),q(null),y(n)},children:e.jsx("div",{className:"flex cursor-pointer",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-sm",children:n.salesInvoice}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Customer: ",n.customerName]})]})})},n._id)):e.jsx("div",{className:"text-center border-slate-400 border rounded-lg",children:e.jsx("p",{className:"text-[red] text-sm py-4",children:N&&Object.keys(N).length>0?"Invoice Not Found!":"Please select a customer to view invoices!"})})]})]}),e.jsxs("div",{className:"col-span-6",children:[e.jsxs("label",{className:"block text-sm mb-1 text-labelColor",children:["Invoice Type ",e.jsx("span",{className:"text-[#bd2e2e] ",children:"*"})]}),e.jsxs("div",{className:"relative w-full",children:[e.jsxs("select",{name:"invoiceType",value:a.invoiceType,onChange:D,className:"block appearance-none w-full h-9  text-zinc-400 bg-white border border-inputBorder text-sm pl-2 pr-8 rounded-md leading-tight focus:outline-none focus:bg-white focus:border-gray-500 cursor-pointer",children:[e.jsx("option",{value:"",className:"text-gray",children:"Select Invoice Type"}),e.jsx("option",{value:"Registered",children:"Registered"}),e.jsx("option",{value:"Deemed Export",children:"Deemed Export"}),e.jsx("option",{value:"SEZ With Payment",children:"SEZ With Payment"}),e.jsx("option",{value:"SEZ Without Payment",children:"SEZ Without Payment"}),e.jsx("option",{value:"Export With Payment",children:"Export With Payment"}),e.jsx("option",{value:"Export Without Payment",children:"Export Without Payment"}),e.jsx("option",{value:"B2C (Large)",children:"B2C (Large)"}),e.jsx("option",{value:"B2C Others",children:"B2C Others"})]}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700",children:e.jsx($,{color:"gray"})})]})]}),e.jsxs("div",{className:"col-span-6 relative",children:[e.jsxs("label",{className:"block text-sm mb-1 text-labelColor",children:["Customer Credit Date ",e.jsx("span",{className:"text-[#bd2e2e] ",children:"*"})]}),e.jsx("div",{className:"relative w-full",children:e.jsx("input",{name:"customerCreditDate",value:a.customerCreditDate,onChange:D,type:"date",className:"block appearance-none w-full h-9 text-zinc-400 bg-white border border-inputBorder text-sm pl-2 rounded-md leading-tight focus:outline-none focus:bg-white focus:border-gray-500 px-2"})})]}),e.jsxs("div",{className:"col-span-6",children:[e.jsxs("label",{className:"block text-sm mb-1 text-labelColor",children:["Payment Mode ",e.jsx("span",{className:"text-[#bd2e2e] ",children:"*"})]}),e.jsxs("div",{className:"relative w-full",children:[e.jsxs("select",{onChange:D,name:"paymentMode",value:a.paymentMode,className:"block appearance-none w-full h-9  text-zinc-400 bg-white border border-inputBorder text-sm  pl-2 pr-8 rounded-md leading-tight focus:outline-none focus:bg-white focus:border-gray-500 cursor-pointer",children:[e.jsx("option",{value:"",children:"Select Payment Mode"}),e.jsx("option",{value:"Cash",children:"Cash"}),e.jsx("option",{value:"Credit",children:"Credit"})]}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700",children:e.jsx($,{color:"gray"})})]})]}),a.paymentMode==="Cash"&&e.jsxs("div",{className:"col-span-6",children:[e.jsxs("label",{className:"block text-sm mb-1 text-labelColor",children:["Paid Through Account ",e.jsx("span",{className:"text-[#bd2e2e] ",children:"*"})]}),e.jsxs("div",{className:"relative w-full",children:[e.jsxs("select",{name:"paidThroughAccountId",onChange:D,value:a.paidThroughAccountId,className:"block appearance-none w-full h-9  text-zinc-400 bg-white border border-inputBorder text-sm  pl-2 pr-8 rounded-md leading-tight focus:outline-none focus:bg-white focus:border-gray-500 cursor-pointer",children:[e.jsx("option",{value:"",children:"Select Account"}),(me=W==null?void 0:W.filter(n=>n.accountSubhead==="Bank"||n.accountSubhead=="Cash"))==null?void 0:me.map(n=>e.jsx("option",{value:n._id,children:n.accountName},n._id))]}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700",children:e.jsx($,{color:"gray"})})]})]}),e.jsx("div",{className:"col-span-6",children:e.jsxs("label",{className:"block text-sm text-labelColor",children:["Subject",e.jsx("input",{name:"subject",onChange:D,value:a.subject,id:"",placeholder:"Enter a subject within 250 Characters",className:"border-inputBorder w-full text-sm border rounded text-dropdownText  mt-1 p-2 h-9 "})]})})]}),e.jsx("p",{className:"font-bold",children:"Add Item"}),e.jsx(ke,{SalesOrderState:a,setSalesOrderState:P,isInterState:U,oneOrganization:g,selectedInvoice:d}),"",e.jsx("br",{}),e.jsx("div",{className:"mt-2",children:e.jsxs("label",{htmlFor:"",className:"block text-sm mb-1 text-labelColor",children:["Add Note",e.jsx("input",{name:"addNotes",id:"",value:a.addNotes,onChange:D,placeholder:"Note",className:"border-inputBorder w-full text-sm border rounded  p-2 h-[57px] "})]})})]})})}),e.jsxs("div",{className:"col-span-4 text-sm",children:[e.jsx("div",{className:"mt-0",children:e.jsxs("label",{htmlFor:"",className:"block text-sm mb-1 text-labelColor",children:["Terms & Conditions",e.jsx("input",{name:"",id:"",placeholder:"Add Terms & Conditions of your business",className:"border-inputBorder w-full text-sm border rounded p-2 h-[57px] mt-2"})]})}),e.jsx("div",{className:"text-sm mt-3 hidden",children:e.jsxs("label",{className:"block  text-sm mb-1 text-labelColor",children:["Attach files to the Debit Notes",e.jsxs("div",{className:"border-inputBorder border-gray-800 w-full border-dashed border p-2 rounded flex flex-col gap-2 justify-center items-center mt-2  bg-white mb-4 ",children:[e.jsxs("span",{className:"text-center inline-flex items-center gap-2",children:[e.jsx(Ie,{}),"Upload File"]}),e.jsx("div",{className:"text-center",children:"Maximum File Size: 1 MB"})]}),e.jsx("p",{className:"text-xs mt-1 text-gray-600"}),e.jsx("input",{disabled:!0,type:"file",className:"hidden",value:"",name:"documents"})]})}),e.jsxs("div",{className:"bg-secondary_main p-5 min-h-max rounded-xl relative mt-2",children:[e.jsxs("div",{className:" pb-4  text-dropdownText border-b-2 border-slate-200 space-y-2",children:[e.jsxs("div",{className:"flex ",children:[e.jsxs("div",{className:"w-[75%]",children:[" ",e.jsx("p",{children:"Sub Total"})]}),e.jsxs("div",{className:"w-full text-end",children:[" ",e.jsxs("p",{className:"text-end",children:[g==null?void 0:g.baseCurrency," ",a.subTotal?a.subTotal:"0.00"," "]})]})]}),e.jsxs("div",{className:"flex ",children:[e.jsxs("div",{className:"w-[75%]",children:[" ",e.jsx("p",{children:" Total Quantity"})]}),e.jsxs("div",{className:"w-full text-end",children:[" ",e.jsx("p",{className:"text-end",children:a.totalItem?a.totalItem:"0"})]})]}),e.jsx("div",{children:U?e.jsxs("div",{className:"flex ",children:[e.jsxs("div",{className:"w-[75%]",children:[" ",e.jsx("p",{children:" IGST"})]}),e.jsxs("div",{className:"w-full text-end",children:[" ",e.jsxs("p",{className:"text-end",children:[g.baseCurrency," ",a.igst?a.igst:"0.00"]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex ",children:[e.jsxs("div",{className:"w-[75%]",children:[" ",e.jsx("p",{children:" SGST"})]}),e.jsxs("div",{className:"w-full text-end",children:[" ",e.jsxs("p",{className:"text-end",children:[g.baseCurrency," ",a.sgst?a.sgst:"0.00"]})]})]}),e.jsxs("div",{className:"flex mt-2",children:[e.jsxs("div",{className:"w-[75%]",children:[" ",e.jsx("p",{children:" CGST"})]}),e.jsxs("div",{className:"w-full text-end",children:[" ",e.jsxs("p",{className:"text-end",children:[g.baseCurrency," ",a.cgst?a.cgst:"0.00"]})]})]})]})}),!U&&e.jsxs("div",{className:"flex",children:[e.jsxs("div",{className:"w-[75%]",children:[" ",e.jsx("p",{children:" Total Tax"})]}),e.jsxs("div",{className:"w-full text-end",children:[" ",e.jsxs("p",{className:"text-end",children:[" ",g.baseCurrency," ",a.totalTax]})]})]})]}),e.jsxs("div",{className:"flex text-black mt-4",children:[e.jsxs("div",{className:"w-[75%] font-bold",children:[" ",e.jsx("p",{children:"Total"})]}),e.jsxs("div",{className:"w-full text-end font-bold text-base",children:[" ",e.jsxs("p",{className:"text-end",children:[" ",g.baseCurrency," ",a.totalAmount?a.totalAmount:"0.00"]})]})]}),e.jsxs("div",{className:"flex gap-4 m-5 justify-end",children:[" ",e.jsx(pe,{variant:"secondary",size:"sm",onClick:be,children:"Cancel"}),e.jsx(pe,{variant:"primary",size:"sm",onClick:he,children:"Save & send"})," "]})]})]})]})]})};export{qe as default};
